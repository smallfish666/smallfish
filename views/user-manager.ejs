<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
  <link rel="stylesheet" href="/css/reset.css">
  <link rel="stylesheet" href="/css/index.css">
</head>
<body>

  <div class="index">

    <%- include('./common/header.ejs', { nickname: nickname, isAdmin: isAdmin }) %>

    <div class="container">

      <%- include('./common/menu.ejs', { isAdmin: isAdmin }) %>
      
      <div class="main">

        <div class="sous">
        <input type="text" placeholder="输入用户昵称">
        <button>搜索</button>
        </div>

        <table>
          <thead>
            <tr>
              <th>序号</th>
              <th>用户名</th>
              <th>用户昵称</th>
              <th>手机号码</th>
              <th>性别</th>
              <th>年龄</th>
              <th>是否管理员</th>
              <th>操作</th>
            </tr>
          </thead>
          
    
    
          <tbody>
            <!-- 循环 userList 显示用户数据 -->
            <% for (var i = 0; i < userList.length; i++) { %>
              <tr>
                <td><%= userList[i]._id %></td>
                <td><%= userList[i].username %></td>
                <td><%= userList[i].nickname %></td>
                <td><%= userList[i].phone %></td>
                <td><%= userList[i].sex || '-' %></td>
                <td><%= userList[i].age || '-' %></td>
                <td><%= parseInt(userList[i].is_admin) ? '是' : '否' %></td>
                <td>
                  <!--
                    1. 如果当前登录的管理员跟这条记录匹配。那么可以修改，
                    2. 如果这条记录是管理员记录的话，那么不可以删除
                   -->

                   <% if (userList[i].username === username) { %>
                    <a href="#" class="update">修改</a>
                  <% } else if (parseInt(userList[i].is_admin)) { %>

                  <% } else { %>
                    <a href="#" class="update">修改</a>
                    <a href="/users/delete?id=<%= userList[i]._id %>">删除</a>
                  <% } %>
                  
                </td>
              </tr>
            <% } %>
           
          </tbody>
        </table>
        <div id="updateBox">
            <h2>修改</h2>
            <form action="/users/update" method="post">
              <label class="change">
                <span>用户名</span>
                <input type="text" name="username" class="updateUser" value="" readonly>
              </label>
              <label class="change">
                <span>昵称</span>
                <input type="text" name="nickname" class="updateNick" value="">
              </label>
              <label class="change">
                <span>电话号码</span>
                <input type="text" name="phone" class="updatePhone" value="">
              </label>
                <input type="submit" value="确认" id="sub">
                <i class="cancle">取消</i>
            </form>
          </div>
        <!-- 通过 传过来  totalPage 来渲染我们的 分页组件 -->

        <ul>
          <% for (var i = 0; i < totalPage; i++) { %>
            <li>
              <a href="/user-manager.html?page=<%= i+1 %>" ><%= i+1 %>页</a>
            </li>
          <% } %>

        </ul>

      </div>
    </div>
  </div>

</body>
</html>
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/jquery/user-manager.js"></script>